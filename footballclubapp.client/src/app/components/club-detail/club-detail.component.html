<!-- Breadcrumb -->
<nav class="bg-light py-3" aria-label="breadcrumb">
  <div class="container">
    <ol class="breadcrumb mb-0">
      <li class="breadcrumb-item"><a routerLink="/clubs" class="text-decoration-none">Clubs</a></li>
      <li class="breadcrumb-item active">{{club?.clubName}}</li>
    </ol>
  </div>
</nav>

<!-- Loading State -->
<div *ngIf="loading" class="container py-5">
  <div class="text-center py-5">
    <div class="spinner-border text-danger" style="width: 4rem; height: 4rem;"></div>
    <p class="mt-3 text-muted">Loading club details...</p>
  </div>
</div>

<!-- Club Details -->
<div *ngIf="club && !loading" class="container py-5">

  <!-- Club Header -->
  <div class="card border-0 shadow-lg mb-4">
    <div class="row g-0">
      <div class="col-md-4 bg-dark d-flex align-items-center justify-content-center p-5">
        <div class="text-center w-100">
          <img [src]="getImageUrl(club.clubLogo)"
               [alt]="club.clubName"
               class="img-fluid"
               style="max-height: 300px; max-width: 100%; object-fit: contain; filter: drop-shadow(0 10px 20px rgba(255,255,255,0.1));"
               onerror="this.src='https://via.placeholder.com/300x300/343a40/ffffff?text=No+Logo'">
        </div>
      </div>
      <div class="col-md-8">
        <div class="card-body p-5">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
              <h1 class="display-4 fw-bold mb-2">{{club.clubName}}</h1>
              <span class="badge bg-danger fs-6 px-3 py-2">{{club.clubCode}}</span>
            </div>
            <span class="badge fs-6 px-4 py-2" [ngClass]="club.isActive ? 'bg-success' : 'bg-secondary'">
              <i class="bi" [ngClass]="club.isActive ? 'bi-check-circle-fill' : 'bi-x-circle-fill'"></i>
              {{club.isActive ? 'Active' : 'Inactive'}}
            </span>
          </div>

          <div class="row g-4 mt-3">
            <div class="col-md-6">
              <div class="d-flex align-items-center p-3 bg-light rounded">
                <div class="bg-danger text-white rounded p-3 me-3">
                  <i class="bi bi-geo-alt-fill fs-4"></i>
                </div>
                <div>
                  <small class="text-muted d-block">Stadium</small>
                  <strong>{{club.stadiumName}}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="d-flex align-items-center p-3 bg-light rounded">
                <div class="bg-danger text-white rounded p-3 me-3">
                  <i class="bi bi-calendar3 fs-4"></i>
                </div>
                <div>
                  <small class="text-muted d-block">Founded</small>
                  <strong>{{club.foundedDate | date:'longDate'}}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="d-flex align-items-center p-3 bg-light rounded">
                <div class="bg-danger text-white rounded p-3 me-3">
                  <i class="bi bi-people-fill fs-4"></i>
                </div>
                <div>
                  <small class="text-muted d-block">Total Players</small>
                  <strong>{{club.players?.length || 0}}</strong>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="d-flex align-items-center p-3 bg-light rounded">
                <div class="bg-danger text-white rounded p-3 me-3">
                  <i class="bi bi-trophy-fill fs-4"></i>
                </div>
                <div>
                  <small class="text-muted d-block">Total Goals</small>
                  <strong>{{getTotalGoals()}}</strong>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-4">
            <button [routerLink]="['/clubs/edit', club.clubId]" class="btn btn-warning btn-lg me-2">
              <i class="bi bi-pencil me-2"></i>Edit Club
            </button>
            <button routerLink="/clubs" class="btn btn-outline-secondary btn-lg">
              <i class="bi bi-arrow-left me-2"></i>Back to List
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Players Section -->
  <div class="card border-0 shadow-lg">
    <div class="card-header bg-dark text-white py-3">
      <div class="d-flex justify-content-between align-items-center">
        <h3 class="mb-0">
          <i class="bi bi-people me-2"></i>
          Squad Roster
        </h3>
        <span class="badge bg-danger fs-6">{{club.players?.length || 0}} Players</span>
      </div>
    </div>

    <div class="card-body p-4">

      <!-- No Players -->
      <div *ngIf="!club.players || club.players.length === 0" class="text-center py-5">
        <i class="bi bi-person-x display-1 text-muted"></i>
        <p class="lead text-muted mt-3">No players registered in this club</p>
      </div>

      <!-- Players Grid -->
      <div class="row g-4" *ngIf="club.players && club.players.length > 0">
        <div class="col-lg-6" *ngFor="let player of club.players">
          <div class="card border h-100 hover-card">
            <div class="card-body">

              <!-- Player Header -->
              <div class="d-flex gap-3 mb-3">
                <div class="position-relative">
                  <img [src]="getImageUrl(player.playerPhoto)"
                       [alt]="player.playerName"
                       class="rounded-circle border border-3 border-danger"
                       style="width: 100px; height: 100px; object-fit: cover;"
                       onerror="this.src='https://via.placeholder.com/100/343a40/ffffff?text=Player'">
                  <span class="position-absolute bottom-0 end-0 badge bg-danger rounded-circle"
                        style="width: 35px; height: 35px; display: flex; align-items: center; justify-content: center;">
                    #{{player.jerseyNumber}}
                  </span>
                </div>

                <div class="flex-grow-1">
                  <h5 class="fw-bold mb-2">{{player.playerName}}</h5>
                  <div class="small text-muted">
                    <div class="mb-1">
                      <i class="bi bi-code text-danger me-1"></i>
                      {{player.playerCode}}
                    </div>
                    <div class="mb-1">
                      <i class="bi bi-flag text-danger me-1"></i>
                      {{player.nationality}}
                    </div>
                    <div>
                      <i class="bi bi-calendar text-danger me-1"></i>
                      {{player.dateOfBirth | date:'mediumDate'}}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Player Stats -->
              <div *ngIf="player.playerDetails && player.playerDetails.length > 0">
                <h6 class="fw-bold mb-3 border-bottom pb-2">
                  <i class="bi bi-graph-up text-danger me-1"></i>
                  Performance Statistics
                </h6>

                <div class="table-responsive">
                  <table class="table table-sm table-hover mb-0">
                    <thead class="table-light">
                      <tr>
                        <th>Position</th>
                        <th>Contract</th>
                        <th>Salary</th>
                        <th class="text-center">Goals</th>
                        <th class="text-center">Assists</th>
                        <th class="text-center">Matches</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let detail of player.playerDetails">
                        <td>
                          <span class="badge bg-primary">{{detail.position?.positionName}}</span>
                        </td>
                        <td class="small">
                          {{detail.contractStart | date:'MMM yyyy'}} - {{detail.contractEnd | date:'MMM yyyy'}}
                        </td>
                        <td class="fw-bold text-success">{{detail.annualSalary | currency}}</td>
                        <td class="text-center">
                          <span class="badge bg-danger">{{detail.goalsScored}}</span>
                        </td>
                        <td class="text-center">
                          <span class="badge bg-info">{{detail.assists}}</span>
                        </td>
                        <td class="text-center">
                          <span class="badge bg-success">{{detail.matchesPlayed}}</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

</div>
